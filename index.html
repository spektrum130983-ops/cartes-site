<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Base de données cartes</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; background: #f4f4f9; }
    h1 { text-align: center; }
    #cards { display: grid; grid-template-columns: repeat(auto-fill, minmax(250px, 1fr)); gap: 20px; }
    .card { background: white; padding: 15px; border-radius: 10px; box-shadow: 0 2px 6px rgba(0,0,0,0.1); }
    .card img { max-width: 100%; height: auto; border-radius: 8px; }
    .meta { font-size: 0.9em; color: #555; margin-top: 5px; }
  </style>
</head>
<body>
  <h1>Ma Collection de Cartes</h1>
  <div id="cards">Chargement…</div>

  <script>
    const sheetURL = "https://docs.google.com/spreadsheets/d/1Qu3UDfkrM2r4XgsyWBxZBlgQtaTw8TOy7CHlI--kSbU/gviz/tq?tqx=out:json&gid=658465532";



    fetch(sheetURL)
      .then(res => res.text())
      .then(text => {
        // Supprimer l’enrobage Google
        const json = JSON.parse(text.substr(47).slice(0, -2));
        const rows = json.table.rows;
        let html = "";

        rows.forEach(row => {
          const serie = row.c[0]?.v || "";
          const nomSet = row.c[1]?.v || "";
          const booster = row.c[2]?.v || "";
          const annee = row.c[3]?.f || "";
          const date = row.c[4]?.f || "";
          const langue = row.c[5]?.v || "";
          const type = row.c[6]?.v || "";
          const nombre = row.c[7]?.f || "";
          const code = row.c[8]?.v || "";
          let image = row.c[9]?.v || "";

          // Convertir Google Drive "view?usp=..." en lien direct
          if (image.includes("drive.google.com")) {
            const id = image.match(/[-\w]{25,}/);
            if (id) image = `https://drive.google.com/uc?id=${id[0]}`;
          }

          html += `
            <div class="card">
              ${image ? `<img src="${image}" alt="${nomSet}">` : ""}
              <h3>${nomSet}</h3>
              <p><b>Série :</b> ${serie}</p>
              <p><b>Booster :</b> ${booster}</p>
              <p class="meta"><b>Année :</b> ${annee} | <b>Date :</b> ${date}</p>
              <p class="meta"><b>Langue :</b> ${langue} | <b>Type :</b> ${type}</p>
              <p class="meta"><b>Nombre :</b> ${nombre} | <b>Code :</b> ${code}</p>
            </div>
          `;
        });

        document.getElementById("cards").innerHTML = html;
      })
      .catch(err => {
        console.error("Erreur de chargement:", err);
        document.getElementById("cards").innerHTML = "Impossible de charger les données.";
      });
  </script>
</body>
</html>



